"use strict";
((typeof self !== 'undefined' ? self : this)["webpackChunkBuilderCv"] = (typeof self !== 'undefined' ? self : this)["webpackChunkBuilderCv"] || []).push([["components_bootstrapvuejs_src_components_Ressouces_MultiSelectTaxo_vue"],{

/***/ "../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue":
/*!*********************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue ***!
  \*********************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _MultiSelectTaxo_vue_vue_type_template_id_565a8d67___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MultiSelectTaxo.vue?vue&type=template&id=565a8d67& */ "../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=template&id=565a8d67&");
/* harmony import */ var _MultiSelectTaxo_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./MultiSelectTaxo.vue?vue&type=script&lang=js& */ "../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=script&lang=js&");
/* harmony import */ var _entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! !../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js */ "./node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js");





/* normalize component */
;
var component = (0,_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_2__["default"])(
  _MultiSelectTaxo_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _MultiSelectTaxo_vue_vue_type_template_id_565a8d67___WEBPACK_IMPORTED_MODULE_0__.render,
  _MultiSelectTaxo_vue_vue_type_template_id_565a8d67___WEBPACK_IMPORTED_MODULE_0__.staticRenderFns,
  false,
  null,
  null,
  null
  
)

/* hot reload */
if (false) { var api; }
component.options.__file = "components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ "../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=script&lang=js&":
/*!**********************************************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=script&lang=js& ***!
  \**********************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_MultiSelectTaxo_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../entity-cv-drupal/node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MultiSelectTaxo.vue?vue&type=script&lang=js& */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=script&lang=js&");
 /* harmony default export */ __webpack_exports__["default"] = (_entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_MultiSelectTaxo_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__["default"]); 

/***/ }),

/***/ "../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=template&id=565a8d67&":
/*!****************************************************************************************************************!*\
  !*** ../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=template&id=565a8d67& ***!
  \****************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "render": function() { return /* reexport safe */ _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_MultiSelectTaxo_vue_vue_type_template_id_565a8d67___WEBPACK_IMPORTED_MODULE_0__.render; },
/* harmony export */   "staticRenderFns": function() { return /* reexport safe */ _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_MultiSelectTaxo_vue_vue_type_template_id_565a8d67___WEBPACK_IMPORTED_MODULE_0__.staticRenderFns; }
/* harmony export */ });
/* harmony import */ var _entity_cv_drupal_node_modules_babel_loader_lib_index_js_clonedRuleSet_126_use_0_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_loaders_templateLoader_js_ruleSet_1_rules_3_entity_cv_drupal_node_modules_vue_vue_loader_v15_lib_index_js_vue_loader_options_MultiSelectTaxo_vue_vue_type_template_id_565a8d67___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../../../entity-cv-drupal/node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!../../../../entity-cv-drupal/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MultiSelectTaxo.vue?vue&type=template&id=565a8d67& */ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=template&id=565a8d67&");


/***/ }),

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=script&lang=js&":
/*!*************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=script&lang=js& ***!
  \*************************************************************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! core-js/modules/es.array.push.js */ "../components_bootstrapvuejs/node_modules/core-js/modules/es.array.push.js");
/* harmony import */ var core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(core_js_modules_es_array_push_js__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var vee_validate__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! vee-validate */ "./node_modules/vee-validate/dist/vee-validate.esm.js");
/* harmony import */ var vue_multiselect__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! vue-multiselect */ "../components_bootstrapvuejs/node_modules/vue-multiselect/dist/vue-multiselect.min.js");
/* harmony import */ var vue_multiselect__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(vue_multiselect__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var drupal_vuejs_src_App_jsonApi_termsTaxo_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! drupal-vuejs/src/App/jsonApi/termsTaxo.js */ "../drupal-vuejs/src/App/jsonApi/termsTaxo.js");
/* harmony import */ var _fieldsDrupal_loadField_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../fieldsDrupal/loadField.js */ "../components_bootstrapvuejs/src/components/fieldsDrupal/loadField.js");





/* harmony default export */ __webpack_exports__["default"] = ({
  name: "MultiSelectTaxo",
  components: {
    ValidationProvider: vee_validate__WEBPACK_IMPORTED_MODULE_4__.ValidationProvider,
    Multiselect: (vue_multiselect__WEBPACK_IMPORTED_MODULE_1___default())
  },
  props: {
    field: {
      type: Object,
      required: true
    },
    model: {
      type: [Object, Array],
      required: true
    },
    namespaceStore: {
      type: String,
      required: true
    },
    parentName: {
      type: String,
      required: true
    }
  },
  data() {
    return {
      isLoading: false,
      options: [],
      value_select: null
    };
  },
  computed: {
    fullname() {
      return this.parentName + this.field.name;
    },
    cardinality() {
      if (this.field.cardinality === -1) {
        return true;
      } else {
        return false;
      }
    },
    /**
     * @see https://skirtles-code.github.io/vue-examples/patterns/computed-v-model.html
     */
    value_computed: {
      get() {
        return this.value_select;
      },
      set(val) {
        this.updateValue(val);
      }
    }
  },
  // watch: {
  //   /**
  //    * L'objectif est que cette valeur soit un reflet de la valeur contenu dans l'entité.
  //    * @param {*} val
  //    */
  //   value_select(val) {
  //     if (this.cardinality) {
  //       const vals = [];
  //       val.forEach((item) => {
  //         vals.push({ target_id: item.value });
  //       });
  //       this.setValue(vals);
  //     } else {
  //       const vals = [];
  //       if (val) vals.push({ target_id: val.value });
  //       this.setValue(vals);
  //     }
  //   },
  // },
  mounted() {
    this.loadDefaults();
  },
  methods: {
    /**
     *
     * @param {*} tid
     */
    getTermByTid(tid) {
      this.isLoading = true;
      // Doit etre dynamique.
      let vocabulary = this.getFistVocab();
      const terms = new drupal_vuejs_src_App_jsonApi_termsTaxo_js__WEBPACK_IMPORTED_MODULE_2__["default"](vocabulary);
      terms.getValueByTid(tid).then(() => {
        const options = terms.getOptions();
        this.options = options;
        if (this.cardinality) {
          this.value_select = options;
        } else if (options[0]) this.value_select = options[0];
        this.isLoading = false;
      }).catch(() => {
        this.isLoading = false;
      });
    },
    /**
     *
     */
    loadDefaults() {
      this.model[this.field.name].forEach(item => {
        this.getTermByTid(item.target_id);
      });
    },
    /**
     * --
     */
    getFistVocab() {
      if (this.field.definition_settings.handler_settings.target_bundles) {
        const keys = Object.keys(this.field.definition_settings.handler_settings.target_bundles);
        return this.field.definition_settings.handler_settings.target_bundles[keys[0]];
      } else if (this.field.definition_settings.target_type) {
        return this.field.definition_settings.target_type;
      } else return null;
    },
    /**
     *
     * @param {*} search
     */
    asyncFind(search) {
      if (search.length >= 2) {
        // Doit etre dynamique.
        let vocabulary = this.getFistVocab();
        const terms = new drupal_vuejs_src_App_jsonApi_termsTaxo_js__WEBPACK_IMPORTED_MODULE_2__["default"](vocabulary);
        this.isLoading = true;
        terms.getSearch(search).then(() => {
          this.options = terms.getOptions();
          this.isLoading = false;
        });
      }
    },
    nameWithLang({
      text
    }) {
      return `${text}`;
    },
    /**
     *
     * @param {*} vals
     */
    setValue(vals) {
      if (this.namespaceStore) {
        this.$store.dispatch(this.namespaceStore + "/setValue", {
          value: vals,
          fieldName: this.fullname
        });
      } else this.$store.dispatch("setValue", {
        value: vals,
        fieldName: this.fullname
      });
    },
    /**
     *
     */
    getRules() {
      return _fieldsDrupal_loadField_js__WEBPACK_IMPORTED_MODULE_3__["default"].getRules(this.field);
    },
    updateValue(val) {
      this.value_select = val;
      if (this.cardinality) {
        const vals = [];
        if (val && val.length) val.forEach(item => {
          vals.push({
            target_id: item.value
          });
        });
        this.setValue(vals);
      } else {
        const vals = [];
        if (val && val.value) vals.push({
          target_id: val.value
        });
        this.setValue(vals);
      }
    }
  }
});

/***/ }),

/***/ "./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=template&id=565a8d67&":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib/index.js??clonedRuleSet-126.use[0]!./node_modules/@vue/vue-loader-v15/lib/loaders/templateLoader.js??ruleSet[1].rules[3]!./node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!../components_bootstrapvuejs/src/components/Ressouces/MultiSelectTaxo.vue?vue&type=template&id=565a8d67& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "render": function() { return /* binding */ render; },
/* harmony export */   "staticRenderFns": function() { return /* binding */ staticRenderFns; }
/* harmony export */ });
var render = function render() {
  var _vm = this,
    _c = _vm._self._c;
  return _c("ValidationProvider", {
    attrs: {
      name: _vm.fullname,
      rules: _vm.getRules()
    },
    scopedSlots: _vm._u([{
      key: "default",
      fn: function (v) {
        return [_c("b-form-group", {
          attrs: {
            label: _vm.field.label,
            description: _vm.field.description
          }
        }, [_c("div", {
          staticClass: "autocomplete"
        }, [_c("multiselect", {
          attrs: {
            options: _vm.options,
            "custom-label": _vm.nameWithLang,
            placeholder: "",
            label: "text",
            "track-by": "text",
            "show-no-results": true,
            "show-labels": false,
            loading: _vm.isLoading,
            multiple: _vm.cardinality,
            "allow-empty": true
          },
          on: {
            "search-change": _vm.asyncFind
          },
          model: {
            value: _vm.value_computed,
            callback: function ($$v) {
              _vm.value_computed = $$v;
            },
            expression: "value_computed"
          }
        }, [_c("template", {
          slot: "noResult"
        }, [_c("span", {
          staticClass: "option__title"
        }, [_vm._v(" Aucun contenu ne correspond à votre recherche ")])]), _c("template", {
          slot: "placeholder"
        }, [_c("span", {
          staticClass: "option__title"
        }, [_vm._v(" Aucun contenu ... ")])]), _c("template", {
          slot: "noOptions"
        }, [_c("span", {
          staticClass: "option__title"
        }, [_vm._v(" Saisir un ou plusieurs caractères ... ")])])], 2), _c("div", {
          staticClass: "text-danger"
        }, _vm._l(v.errors, function (error, ii) {
          return _c("small", {
            key: ii,
            staticClass: "d-block"
          }, [_vm._v(" " + _vm._s(error) + " ")]);
        }), 0)], 1)])];
      }
    }])
  });
};
var staticRenderFns = [];
render._withStripped = true;


/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQnVpbGRlckN2LnVtZC5taW4uY29tcG9uZW50c19ib290c3RyYXB2dWVqc19zcmNfY29tcG9uZW50c19SZXNzb3VjZXNfTXVsdGlTZWxlY3RUYXhvX3Z1ZS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQThGO0FBQzNCO0FBQ0w7OztBQUc5RDtBQUNBLENBQTBIO0FBQzFILGdCQUFnQixnSUFBVTtBQUMxQixFQUFFLHFGQUFNO0FBQ1IsRUFBRSx1RkFBTTtBQUNSLEVBQUUsZ0dBQWU7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSSxLQUFVLEVBQUUsWUFpQmY7QUFDRDtBQUNBLCtEQUFlOzs7Ozs7Ozs7Ozs7QUN0Q2lQLENBQUMsK0RBQWUsc1BBQUcsRUFBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUUyQ2xPO0FBQ1I7QUFDd0I7QUFDYjtBQUNyRCwrREFBZTtFQUNmQTtFQUNBQztJQUNBQyxrQkFBQUEsOERBQUFBO0lBQ0FDLFdBQUFBLDBEQUFBQTtFQUNBO0VBQ0FDO0lBQ0FDO01BQUFDO01BQUFDO0lBQUE7SUFDQUM7TUFBQUY7TUFBQUM7SUFBQTtJQUNBRTtNQUFBSDtNQUFBQztJQUFBO0lBQ0FHO01BQ0FKO01BQ0FDO0lBQ0E7RUFDQTtFQUNBSTtJQUNBO01BQ0FDO01BQ0FDO01BQ0FDO0lBQ0E7RUFDQTtFQUNBQztJQUNBQztNQUNBO0lBQ0E7SUFDQUM7TUFDQTtRQUNBO01BQ0E7UUFDQTtNQUNBO0lBQ0E7SUFDQTtBQUNBO0FBQ0E7SUFDQUM7TUFDQUM7UUFDQTtNQUNBO01BQ0FDO1FBQ0E7TUFDQTtJQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBQztJQUNBO0VBQ0E7RUFDQUM7SUFDQTtBQUNBO0FBQ0E7QUFDQTtJQUNBQztNQUNBO01B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QixhQUFhLEdBQUcsSUFBSSIsInNvdXJjZXMiOlsid2VicGFjazovL0J1aWxkZXJDdi8uLi9jb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzL3NyYy9jb21wb25lbnRzL1Jlc3NvdWNlcy9NdWx0aVNlbGVjdFRheG8udnVlPzZlZjAiLCJ3ZWJwYWNrOi8vQnVpbGRlckN2Ly4uL2NvbXBvbmVudHNfYm9vdHN0cmFwdnVlanMvc3JjL2NvbXBvbmVudHMvUmVzc291Y2VzL011bHRpU2VsZWN0VGF4by52dWU/OTY1NSIsIndlYnBhY2s6Ly9CdWlsZGVyQ3YvLi4vY29tcG9uZW50c19ib290c3RyYXB2dWVqcy9zcmMvY29tcG9uZW50cy9SZXNzb3VjZXMvTXVsdGlTZWxlY3RUYXhvLnZ1ZT9lMjU0Iiwid2VicGFjazovL0J1aWxkZXJDdi8uLi9jb21wb25lbnRzX2Jvb3RzdHJhcHZ1ZWpzL3NyYy9jb21wb25lbnRzL1Jlc3NvdWNlcy9NdWx0aVNlbGVjdFRheG8udnVlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHJlbmRlciwgc3RhdGljUmVuZGVyRm5zIH0gZnJvbSBcIi4vTXVsdGlTZWxlY3RUYXhvLnZ1ZT92dWUmdHlwZT10ZW1wbGF0ZSZpZD01NjVhOGQ2NyZcIlxuaW1wb3J0IHNjcmlwdCBmcm9tIFwiLi9NdWx0aVNlbGVjdFRheG8udnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5leHBvcnQgKiBmcm9tIFwiLi9NdWx0aVNlbGVjdFRheG8udnVlP3Z1ZSZ0eXBlPXNjcmlwdCZsYW5nPWpzJlwiXG5cblxuLyogbm9ybWFsaXplIGNvbXBvbmVudCAqL1xuaW1wb3J0IG5vcm1hbGl6ZXIgZnJvbSBcIiEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9AdnVlL3Z1ZS1sb2FkZXItdjE1L2xpYi9ydW50aW1lL2NvbXBvbmVudE5vcm1hbGl6ZXIuanNcIlxudmFyIGNvbXBvbmVudCA9IG5vcm1hbGl6ZXIoXG4gIHNjcmlwdCxcbiAgcmVuZGVyLFxuICBzdGF0aWNSZW5kZXJGbnMsXG4gIGZhbHNlLFxuICBudWxsLFxuICBudWxsLFxuICBudWxsXG4gIFxuKVxuXG4vKiBob3QgcmVsb2FkICovXG5pZiAobW9kdWxlLmhvdCkge1xuICB2YXIgYXBpID0gcmVxdWlyZShcIi9zaXRld2ViL0FwcFZ1ZWpzL2VudGl0eS1jdi1kcnVwYWwvbm9kZV9tb2R1bGVzL3Z1ZS1ob3QtcmVsb2FkLWFwaS9kaXN0L2luZGV4LmpzXCIpXG4gIGFwaS5pbnN0YWxsKHJlcXVpcmUoJ3Z1ZScpKVxuICBpZiAoYXBpLmNvbXBhdGlibGUpIHtcbiAgICBtb2R1bGUuaG90LmFjY2VwdCgpXG4gICAgaWYgKCFhcGkuaXNSZWNvcmRlZCgnNTY1YThkNjcnKSkge1xuICAgICAgYXBpLmNyZWF0ZVJlY29yZCgnNTY1YThkNjcnLCBjb21wb25lbnQub3B0aW9ucylcbiAgICB9IGVsc2Uge1xuICAgICAgYXBpLnJlbG9hZCgnNTY1YThkNjcnLCBjb21wb25lbnQub3B0aW9ucylcbiAgICB9XG4gICAgbW9kdWxlLmhvdC5hY2NlcHQoXCIuL011bHRpU2VsZWN0VGF4by52dWU/dnVlJnR5cGU9dGVtcGxhdGUmaWQ9NTY1YThkNjcmXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGFwaS5yZXJlbmRlcignNTY1YThkNjcnLCB7XG4gICAgICAgIHJlbmRlcjogcmVuZGVyLFxuICAgICAgICBzdGF0aWNSZW5kZXJGbnM6IHN0YXRpY1JlbmRlckZuc1xuICAgICAgfSlcbiAgICB9KVxuICB9XG59XG5jb21wb25lbnQub3B0aW9ucy5fX2ZpbGUgPSBcImNvbXBvbmVudHNfYm9vdHN0cmFwdnVlanMvc3JjL2NvbXBvbmVudHMvUmVzc291Y2VzL011bHRpU2VsZWN0VGF4by52dWVcIlxuZXhwb3J0IGRlZmF1bHQgY29tcG9uZW50LmV4cG9ydHMiLCJpbXBvcnQgbW9kIGZyb20gXCItIS4uLy4uLy4uLy4uL2VudGl0eS1jdi1kcnVwYWwvbm9kZV9tb2R1bGVzL2JhYmVsLWxvYWRlci9saWIvaW5kZXguanM/P2Nsb25lZFJ1bGVTZXQtMTI2LnVzZVswXSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9AdnVlL3Z1ZS1sb2FkZXItdjE1L2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vTXVsdGlTZWxlY3RUYXhvLnZ1ZT92dWUmdHlwZT1zY3JpcHQmbGFuZz1qcyZcIjsgZXhwb3J0IGRlZmF1bHQgbW9kOyBleHBvcnQgKiBmcm9tIFwiLSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9iYWJlbC1sb2FkZXIvbGliL2luZGV4LmpzPz9jbG9uZWRSdWxlU2V0LTEyNi51c2VbMF0hLi4vLi4vLi4vLi4vZW50aXR5LWN2LWRydXBhbC9ub2RlX21vZHVsZXMvQHZ1ZS92dWUtbG9hZGVyLXYxNS9saWIvaW5kZXguanM/P3Z1ZS1sb2FkZXItb3B0aW9ucyEuL011bHRpU2VsZWN0VGF4by52dWU/dnVlJnR5cGU9c2NyaXB0Jmxhbmc9anMmXCIiLCJleHBvcnQgKiBmcm9tIFwiLSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9iYWJlbC1sb2FkZXIvbGliL2luZGV4LmpzPz9jbG9uZWRSdWxlU2V0LTEyNi51c2VbMF0hLi4vLi4vLi4vLi4vZW50aXR5LWN2LWRydXBhbC9ub2RlX21vZHVsZXMvQHZ1ZS92dWUtbG9hZGVyLXYxNS9saWIvbG9hZGVycy90ZW1wbGF0ZUxvYWRlci5qcz8/cnVsZVNldFsxXS5ydWxlc1szXSEuLi8uLi8uLi8uLi9lbnRpdHktY3YtZHJ1cGFsL25vZGVfbW9kdWxlcy9AdnVlL3Z1ZS1sb2FkZXItdjE1L2xpYi9pbmRleC5qcz8/dnVlLWxvYWRlci1vcHRpb25zIS4vTXVsdGlTZWxlY3RUYXhvLnZ1ZT92dWUmdHlwZT10ZW1wbGF0ZSZpZD01NjVhOGQ2NyZcIiIsIjx0ZW1wbGF0ZT5cbiAgPFZhbGlkYXRpb25Qcm92aWRlciB2LXNsb3Q9XCJ2XCIgOm5hbWU9XCJmdWxsbmFtZVwiIDpydWxlcz1cImdldFJ1bGVzKClcIj5cbiAgICA8Yi1mb3JtLWdyb3VwIDpsYWJlbD1cImZpZWxkLmxhYmVsXCIgOmRlc2NyaXB0aW9uPVwiZmllbGQuZGVzY3JpcHRpb25cIj5cbiAgICAgIDxkaXYgY2xhc3M9XCJhdXRvY29tcGxldGVcIj5cbiAgICAgICAgPG11bHRpc2VsZWN0XG4gICAgICAgICAgdi1tb2RlbD1cInZhbHVlX2NvbXB1dGVkXCJcbiAgICAgICAgICA6b3B0aW9ucz1cIm9wdGlvbnNcIlxuICAgICAgICAgIDpjdXN0b20tbGFiZWw9XCJuYW1lV2l0aExhbmdcIlxuICAgICAgICAgIHBsYWNlaG9sZGVyPVwiXCJcbiAgICAgICAgICBsYWJlbD1cInRleHRcIlxuICAgICAgICAgIHRyYWNrLWJ5PVwidGV4dFwiXG4gICAgICAgICAgOnNob3ctbm8tcmVzdWx0cz1cInRydWVcIlxuICAgICAgICAgIDpzaG93LWxhYmVscz1cImZhbHNlXCJcbiAgICAgICAgICA6bG9hZGluZz1cImlzTG9hZGluZ1wiXG4gICAgICAgICAgOm11bHRpcGxlPVwiY2FyZGluYWxpdHlcIlxuICAgICAgICAgIDphbGxvdy1lbXB0eT1cInRydWVcIlxuICAgICAgICAgIEBzZWFyY2gtY2hhbmdlPVwiYXN5bmNGaW5kXCJcbiAgICAgICAgPlxuICAgICAgICAgIDx0ZW1wbGF0ZSBzbG90PVwibm9SZXN1bHRcIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwib3B0aW9uX190aXRsZVwiPlxuICAgICAgICAgICAgICBBdWN1biBjb250ZW51IG5lIGNvcnJlc3BvbmQgw6Agdm90cmUgcmVjaGVyY2hlXG4gICAgICAgICAgICA8L3NwYW4+XG4gICAgICAgICAgPC90ZW1wbGF0ZT5cbiAgICAgICAgICA8dGVtcGxhdGUgc2xvdD1cInBsYWNlaG9sZGVyXCI+XG4gICAgICAgICAgICA8c3BhbiBjbGFzcz1cIm9wdGlvbl9fdGl0bGVcIj4gQXVjdW4gY29udGVudSAuLi4gPC9zcGFuPlxuICAgICAgICAgIDwvdGVtcGxhdGU+XG4gICAgICAgICAgPHRlbXBsYXRlIHNsb3Q9XCJub09wdGlvbnNcIj5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwib3B0aW9uX190aXRsZVwiPlxuICAgICAgICAgICAgICBTYWlzaXIgdW4gb3UgcGx1c2lldXJzIGNhcmFjdMOocmVzIC4uLlxuICAgICAgICAgICAgPC9zcGFuPlxuICAgICAgICAgIDwvdGVtcGxhdGU+XG4gICAgICAgIDwvbXVsdGlzZWxlY3Q+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJ0ZXh0LWRhbmdlclwiPlxuICAgICAgICAgIDxzbWFsbCB2LWZvcj1cIihlcnJvciwgaWkpIGluIHYuZXJyb3JzXCIgOmtleT1cImlpXCIgY2xhc3M9XCJkLWJsb2NrXCI+XG4gICAgICAgICAgICB7eyBlcnJvciB9fVxuICAgICAgICAgIDwvc21hbGw+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgPC9iLWZvcm0tZ3JvdXA+XG4gIDwvVmFsaWRhdGlvblByb3ZpZGVyPlxuPC90ZW1wbGF0ZT5cblxuPHNjcmlwdD5cbmltcG9ydCB7IFZhbGlkYXRpb25Qcm92aWRlciB9IGZyb20gXCJ2ZWUtdmFsaWRhdGVcIjtcbmltcG9ydCBNdWx0aXNlbGVjdCBmcm9tIFwidnVlLW11bHRpc2VsZWN0XCI7XG5pbXBvcnQgdGVybXNUYXhvIGZyb20gXCJkcnVwYWwtdnVlanMvc3JjL0FwcC9qc29uQXBpL3Rlcm1zVGF4by5qc1wiO1xuaW1wb3J0IGxvYWRGaWVsZCBmcm9tIFwiLi4vZmllbGRzRHJ1cGFsL2xvYWRGaWVsZC5qc1wiO1xuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiBcIk11bHRpU2VsZWN0VGF4b1wiLFxuICBjb21wb25lbnRzOiB7XG4gICAgVmFsaWRhdGlvblByb3ZpZGVyLFxuICAgIE11bHRpc2VsZWN0LFxuICB9LFxuICBwcm9wczoge1xuICAgIGZpZWxkOiB7IHR5cGU6IE9iamVjdCwgcmVxdWlyZWQ6IHRydWUgfSxcbiAgICBtb2RlbDogeyB0eXBlOiBbT2JqZWN0LCBBcnJheV0sIHJlcXVpcmVkOiB0cnVlIH0sXG4gICAgbmFtZXNwYWNlU3RvcmU6IHsgdHlwZTogU3RyaW5nLCByZXF1aXJlZDogdHJ1ZSB9LFxuICAgIHBhcmVudE5hbWU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gIH0sXG4gIGRhdGEoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTG9hZGluZzogZmFsc2UsXG4gICAgICBvcHRpb25zOiBbXSxcbiAgICAgIHZhbHVlX3NlbGVjdDogbnVsbCxcbiAgICB9O1xuICB9LFxuICBjb21wdXRlZDoge1xuICAgIGZ1bGxuYW1lKCkge1xuICAgICAgcmV0dXJuIHRoaXMucGFyZW50TmFtZSArIHRoaXMuZmllbGQubmFtZTtcbiAgICB9LFxuICAgIGNhcmRpbmFsaXR5KCkge1xuICAgICAgaWYgKHRoaXMuZmllbGQuY2FyZGluYWxpdHkgPT09IC0xKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH0sXG4gICAgLyoqXG4gICAgICogQHNlZSBodHRwczovL3NraXJ0bGVzLWNvZGUuZ2l0aHViLmlvL3Z1ZS1leGFtcGxlcy9wYXR0ZXJucy9jb21wdXRlZC12LW1vZGVsLmh0bWxcbiAgICAgKi9cbiAgICB2YWx1ZV9jb21wdXRlZDoge1xuICAgICAgZ2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy52YWx1ZV9zZWxlY3Q7XG4gICAgICB9LFxuICAgICAgc2V0KHZhbCkge1xuICAgICAgICB0aGlzLnVwZGF0ZVZhbHVlKHZhbCk7XG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIC8vIHdhdGNoOiB7XG4gIC8vICAgLyoqXG4gIC8vICAgICogTCdvYmplY3RpZiBlc3QgcXVlIGNldHRlIHZhbGV1ciBzb2l0IHVuIHJlZmxldCBkZSBsYSB2YWxldXIgY29udGVudSBkYW5zIGwnZW50aXTDqS5cbiAgLy8gICAgKiBAcGFyYW0geyp9IHZhbFxuICAvLyAgICAqL1xuICAvLyAgIHZhbHVlX3NlbGVjdCh2YWwpIHtcbiAgLy8gICAgIGlmICh0aGlzLmNhcmRpbmFsaXR5KSB7XG4gIC8vICAgICAgIGNvbnN0IHZhbHMgPSBbXTtcbiAgLy8gICAgICAgdmFsLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgLy8gICAgICAgICB2YWxzLnB1c2goeyB0YXJnZXRfaWQ6IGl0ZW0udmFsdWUgfSk7XG4gIC8vICAgICAgIH0pO1xuICAvLyAgICAgICB0aGlzLnNldFZhbHVlKHZhbHMpO1xuICAvLyAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgY29uc3QgdmFscyA9IFtdO1xuICAvLyAgICAgICBpZiAodmFsKSB2YWxzLnB1c2goeyB0YXJnZXRfaWQ6IHZhbC52YWx1ZSB9KTtcbiAgLy8gICAgICAgdGhpcy5zZXRWYWx1ZSh2YWxzKTtcbiAgLy8gICAgIH1cbiAgLy8gICB9LFxuICAvLyB9LFxuICBtb3VudGVkKCkge1xuICAgIHRoaXMubG9hZERlZmF1bHRzKCk7XG4gIH0sXG4gIG1ldGhvZHM6IHtcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Kn0gdGlkXG4gICAgICovXG4gICAgZ2V0VGVybUJ5VGlkKHRpZCkge1xuICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlO1xuICAgICAgLy8gRG9pdCBldHJlIGR5bmFtaXF1ZS5cbiAgICAgIGxldCB2b2NhYnVsYXJ5ID0gdGhpcy5nZXRGaXN0Vm9jYWIoKTtcbiAgICAgIGNvbnN0IHRlcm1zID0gbmV3IHRlcm1zVGF4byh2b2NhYnVsYXJ5KTtcbiAgICAgIHRlcm1zXG4gICAgICAgIC5nZXRWYWx1ZUJ5VGlkKHRpZClcbiAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0ZXJtcy5nZXRPcHRpb25zKCk7XG4gICAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgICBpZiAodGhpcy5jYXJkaW5hbGl0eSkge1xuICAgICAgICAgICAgdGhpcy52YWx1ZV9zZWxlY3QgPSBvcHRpb25zO1xuICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9uc1swXSkgdGhpcy52YWx1ZV9zZWxlY3QgPSBvcHRpb25zWzBdO1xuICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5pc0xvYWRpbmcgPSBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGxvYWREZWZhdWx0cygpIHtcbiAgICAgIHRoaXMubW9kZWxbdGhpcy5maWVsZC5uYW1lXS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICAgIHRoaXMuZ2V0VGVybUJ5VGlkKGl0ZW0udGFyZ2V0X2lkKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogLS1cbiAgICAgKi9cbiAgICBnZXRGaXN0Vm9jYWIoKSB7XG4gICAgICBpZiAodGhpcy5maWVsZC5kZWZpbml0aW9uX3NldHRpbmdzLmhhbmRsZXJfc2V0dGluZ3MudGFyZ2V0X2J1bmRsZXMpIHtcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKFxuICAgICAgICAgIHRoaXMuZmllbGQuZGVmaW5pdGlvbl9zZXR0aW5ncy5oYW5kbGVyX3NldHRpbmdzLnRhcmdldF9idW5kbGVzXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkLmRlZmluaXRpb25fc2V0dGluZ3MuaGFuZGxlcl9zZXR0aW5ncy50YXJnZXRfYnVuZGxlc1tcbiAgICAgICAgICBrZXlzWzBdXG4gICAgICAgIF07XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuZmllbGQuZGVmaW5pdGlvbl9zZXR0aW5ncy50YXJnZXRfdHlwZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZC5kZWZpbml0aW9uX3NldHRpbmdzLnRhcmdldF90eXBlO1xuICAgICAgfSBlbHNlIHJldHVybiBudWxsO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICpcbiAgICAgKiBAcGFyYW0geyp9IHNlYXJjaFxuICAgICAqL1xuICAgIGFzeW5jRmluZChzZWFyY2gpIHtcbiAgICAgIGlmIChzZWFyY2gubGVuZ3RoID49IDIpIHtcbiAgICAgICAgLy8gRG9pdCBldHJlIGR5bmFtaXF1ZS5cbiAgICAgICAgbGV0IHZvY2FidWxhcnkgPSB0aGlzLmdldEZpc3RWb2NhYigpO1xuICAgICAgICBjb25zdCB0ZXJtcyA9IG5ldyB0ZXJtc1RheG8odm9jYWJ1bGFyeSk7XG4gICAgICAgIHRoaXMuaXNMb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgdGVybXMuZ2V0U2VhcmNoKHNlYXJjaCkudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5vcHRpb25zID0gdGVybXMuZ2V0T3B0aW9ucygpO1xuICAgICAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG5cbiAgICBuYW1lV2l0aExhbmcoeyB0ZXh0IH0pIHtcbiAgICAgIHJldHVybiBgJHt0ZXh0fWA7XG4gICAgfSxcbiAgICAvKipcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Kn0gdmFsc1xuICAgICAqL1xuICAgIHNldFZhbHVlKHZhbHMpIHtcbiAgICAgIGlmICh0aGlzLm5hbWVzcGFjZVN0b3JlKSB7XG4gICAgICAgIHRoaXMuJHN0b3JlLmRpc3BhdGNoKHRoaXMubmFtZXNwYWNlU3RvcmUgKyBcIi9zZXRWYWx1ZVwiLCB7XG4gICAgICAgICAgdmFsdWU6IHZhbHMsXG4gICAgICAgICAgZmllbGROYW1lOiB0aGlzLmZ1bGxuYW1lLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZVxuICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaChcInNldFZhbHVlXCIsIHtcbiAgICAgICAgICB2YWx1ZTogdmFscyxcbiAgICAgICAgICBmaWVsZE5hbWU6IHRoaXMuZnVsbG5hbWUsXG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBnZXRSdWxlcygpIHtcbiAgICAgIHJldHVybiBsb2FkRmllbGQuZ2V0UnVsZXModGhpcy5maWVsZCk7XG4gICAgfSxcbiAgICB1cGRhdGVWYWx1ZSh2YWwpIHtcbiAgICAgIHRoaXMudmFsdWVfc2VsZWN0ID0gdmFsO1xuICAgICAgaWYgKHRoaXMuY2FyZGluYWxpdHkpIHtcbiAgICAgICAgY29uc3QgdmFscyA9IFtdO1xuICAgICAgICBpZiAodmFsICYmIHZhbC5sZW5ndGgpXG4gICAgICAgICAgdmFsLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHZhbHMucHVzaCh7IHRhcmdldF9pZDogaXRlbS52YWx1ZSB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZXRWYWx1ZSh2YWxzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IHZhbHMgPSBbXTtcbiAgICAgICAgaWYgKHZhbCAmJiB2YWwudmFsdWUpIHZhbHMucHVzaCh7IHRhcmdldF9pZDogdmFsLnZhbHVlIH0pO1xuICAgICAgICB0aGlzLnNldFZhbHVlKHZhbHMpO1xuICAgICAgfVxuICAgIH0sXG4gIH0sXG59O1xuPC9zY3JpcHQ+XG4iXSwibmFtZXMiOlsibmFtZSIsImNvbXBvbmVudHMiLCJWYWxpZGF0aW9uUHJvdmlkZXIiLCJNdWx0aXNlbGVjdCIsInByb3BzIiwiZmllbGQiLCJ0eXBlIiwicmVxdWlyZWQiLCJtb2RlbCIsIm5hbWVzcGFjZVN0b3JlIiwicGFyZW50TmFtZSIsImRhdGEiLCJpc0xvYWRpbmciLCJvcHRpb25zIiwidmFsdWVfc2VsZWN0IiwiY29tcHV0ZWQiLCJmdWxsbmFtZSIsImNhcmRpbmFsaXR5IiwidmFsdWVfY29tcHV0ZWQiLCJnZXQiLCJzZXQiLCJtb3VudGVkIiwibWV0aG9kcyIsImdldFRlcm1CeVRpZCIsInRlcm1zIiwiZ2V0VmFsdWVCeVRpZCIsInRoZW4iLCJjYXRjaCIsImxvYWREZWZhdWx0cyIsImdldEZpc3RWb2NhYiIsImtleXMiLCJhc3luY0ZpbmQiLCJuYW1lV2l0aExhbmciLCJ0ZXh0Iiwic2V0VmFsdWUiLCJ2YWx1ZSIsImZpZWxkTmFtZSIsImdldFJ1bGVzIiwidXBkYXRlVmFsdWUiLCJ2YWwiLCJ2YWxzIiwidGFyZ2V0X2lkIiwicmVuZGVyIiwiX3ZtIiwiX2MiLCJfc2VsZiIsImF0dHJzIiwicnVsZXMiLCJzY29wZWRTbG90cyIsIl91Iiwia2V5IiwiZm4iLCJ2IiwibGFiZWwiLCJkZXNjcmlwdGlvbiIsInN0YXRpY0NsYXNzIiwicGxhY2Vob2xkZXIiLCJsb2FkaW5nIiwibXVsdGlwbGUiLCJvbiIsImNhbGxiYWNrIiwiJCR2IiwiZXhwcmVzc2lvbiIsInNsb3QiLCJfdiIsIl9sIiwiZXJyb3JzIiwiZXJyb3IiLCJpaSIsIl9zIiwic3RhdGljUmVuZGVyRm5zIiwiX3dpdGhTdHJpcHBlZCJdLCJzb3VyY2VSb290IjoiIn0=