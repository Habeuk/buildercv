"use strict";(("undefined"!==typeof self?self:this)["webpackChunkBuilderCv"]=("undefined"!==typeof self?self:this)["webpackChunkBuilderCv"]||[]).push([[644],{9506:function(t,e,s){var i=s(9505),o=TypeError;t.exports=function(t,e){if(!delete t[e])throw o("Cannot delete property "+i(e)+" of "+i(t))}},6446:function(t,e,s){var i=s(5276),o=s(4633),n=s(9327),r=s(9208),a=s(9506),c=s(9770),l=1!==[].unshift(0),u=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();i({target:"Array",proto:!0,arity:1,forced:l||u},{unshift:function(t){var e=o(this),s=n(e),i=arguments.length;if(i){c(s+i);var l=s;while(l--){var u=l+i;l in e?e[u]=e[l]:a(e,u)}for(var d=0;d<i;d++)e[d]=arguments[d]}return r(e,s+i)}})},7644:function(t,e,s){s.r(e),s.d(e,{default:function(){return St}});var i=function(){var t=this,e=t._self._c;return e("ValidationObserver",{ref:"formValidate",attrs:{tag:"form"}},[e("div",{staticClass:"login-page",attrs:{facebook_app_is_define:t.facebook_app_is_define}},[t.alertDisplay?e("div",{staticClass:"alert w-100",class:t.alertType,attrs:{role:"alert"},domProps:{innerHTML:t._s(t.alertText)}}):t._e(),t.isBusy?e("div",{staticClass:"spinner-grow text-primary",staticStyle:{width:"3rem",height:"3rem"},attrs:{role:"status"}},[e("span",{staticClass:"sr-only"},[t._v("Chargement ...")])]):t._e(),e("transition",{attrs:{name:"customslide"}},[e("div",{staticClass:"block-center"},[e(t.stepe,{tag:"component",attrs:{urlLogo:t.urlLogo,formValidate:t.formValidate,"action-after-login":t.actionAfterLogin,"model-register-form":t.modelRegisterForm,"show-password":t.showPassword,"action-after-register":t.actionAfterRegister,"show-modal-success":t.showModalSuccess,configs_login_rx_vuejs:t.configs_login_rx_vuejs},on:{"select-stepe":t.selectStepe}})],1)])],1),e("div",{staticClass:"politik-secur mx-auto text-center"},[t._t("condition_utilisation",(function(){return[t.configs_login_rx_vuejs&&t.configs_login_rx_vuejs.texts&&t.configs_login_rx_vuejs.texts.condition_utilisation?e("div",{domProps:{innerHTML:t._s(t.configs_login_rx_vuejs.texts.condition_utilisation.value)}}):t._e()]}))],2)])},o=[],n=(s(5251),s(7203)),r=s.n(n),a=s(5389),c={AfterRedirect(t="reload",e=null,s=null){console.log("AfterRedirect action .",t);var i=null;if("redirect"==t&&e);else if("home"==t)window.location.assign("/");else if("reload"==t)window.location.reload();else if("emit_even"==t){var o=new CustomEvent("login_rx_vuejs__user_is_login");document.dispatchEvent(o)}else if("emit_even_register"==t){o=new CustomEvent("login_rx_vuejs__user_is_register");document.dispatchEvent(o)}else"default"==t&&(s.reponse&&s.reponse.config.url!==s.reponse.request.responseURL?window.location.assign(s.reponse.request.responseURL):s.data&&s.data.createuser?i="final-gl-register":s.data&&window.location.reload());return i}},l=s(1232);const u=new(r());var d={...c,messages:{log_email:"Email ou Nom d'utilisateur",pass:"Mot de passe",login:"Nom d'utilisateur",mail:"Email",submit:{first:"Suivant",connect:"Connexion",register:"S'inscrire",final:"terminée"},devis_create_user:"Votre compte a été creer sur <a href='/'> lesroisdelareno.fr </a>. <br> <strong> Bien vouloir verifier votre boite mail afin de valider votre compte </strong>"},modalSuccess(t,e){return a.Ht.modalSuccess(t,e)},msgCreate(t){var e=u.$createElement;const s=[];for(const i in t)s.push(e("p",{domProps:{innerHTML:t[i]},style:{lineHeight:"25px",fontSize:"17px",padding:"15px 15px 0px",margin:0}},[]));return e("div",{},[s])},connexionUser(t,e){return new Promise(((s,i)=>{let o="/login-rx-vuejs/user-connexion";l.Z.post(o,t).then((t=>{this.AfterRedirect(e,null,t),s(t)})).catch((t=>{i(t)}))}))}},f=s(4373),g={user:{},FB:null,appId:"",scope:"public_profile, email",version:"v11.0",openPopup(){var t=this;window.FB.login((t=>{this.statusChangeCallback(t,!0)}),{scope:t.scope,return_scopes:!0})},logOut(){window.FB.logout((function(t){this.onLogOut(t)}))},onLogOut(t){console.log("Déconnetion réussi",t)},statusChangeCallback(t,e=!1){if(this.user=t,e){var s=new CustomEvent("wbu-fb-status-change");document.dispatchEvent(s)}console.log("status",this.user)},getUserStatus(){var t=this;window.FB.getLoginStatus((function(e){t.statusChangeCallback(e)}))},chargement(){var t=this,e=document.getElementsByTagName("head")[0],s=document.createElement("script");e.appendChild(s),s.id="facebook-jssdk-021",s.onload=function(){function e(){window.FB?(t.FB=window.FB,t.FB.init({appId:t.appId,cookie:!0,xfbml:!0,version:t.version,statue:!1}),console.log("Chargement du JS facebook"),t.getUserStatus()):(console.log("facebook not load"),setTimeout((()=>{e()}),900))}e()},s.src="https://connect.facebook.net/en_US/sdk.js"}},m=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-center"},[e("a",{staticClass:"content-center__img",attrs:{href:"/"}},[e("img",{staticClass:"img-fluid",attrs:{src:t.urlLogo,alt:""}})]),e("h4",{staticClass:"title"},[t._v("Connectez vous avec")]),e("div",{staticClass:"content-center__btn-column"},[e("logingoogle",{attrs:{idHtml:"default","action-after-login":t.actionAfterLogin}}),e("div",{staticClass:"btn-login btn-login--facebook",on:{click:t.loginFacebook}},[e("span",{staticClass:"btn-login__icon icon-facebook"}),e("i",{staticClass:"btn-login__text"},[t._v(" Facebook ")]),"facebook"===t.waiting?e("svgWaiting"):t._e()],1)],1),e("strong",{staticClass:"d-block"},[t._v(" Ou ")]),e("hr",{staticClass:"diviseur"}),e("h3",{staticClass:"content-center__title"},[t._v(t._s(t.messages.log_email))]),e("div",{staticClass:"form-group content-center__input"},[e("ValidationProvider",{attrs:{name:"name",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name[0].value,expression:"form.name[0].value"}],staticClass:"form-control",attrs:{type:"text",name:"name"},domProps:{value:t.form.name[0].value},on:{input:function(e){e.target.composing||t.$set(t.form.name[0],"value",e.target.value)}}}),e("div",{staticClass:"text-danger text-small"},t._l(s.errors,(function(s,i){return e("small",{key:i,staticClass:"d-block"},[t._v(" "+t._s(s)+" ")])})),0)]}}])})],1),e("div",{staticClass:"content-center__btn"},[e("div",{staticClass:"btn-login btn-login--connexion",on:{click:t.checkUserStatus}},[e("span",{staticClass:"btn-login__text"},[t._v(" "+t._s(t.messages.submit.first)+" ")]),"wait"===t.waiting?e("svgWaiting"):t._e()],1)])])},p=[],h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"buttton-google-aouth",class:t.classRender,attrs:{id:t.idHtmlrender,client_google_is_define:t.client_google_is_define}})},_=[],v={userAccess:{},client_id:"513247959752-qapd9jb30pdtoh51m0h53070a2v8c4er.apps.googleusercontent.com"};s(6446);
/*!
 * vuex v3.6.2
 * (c) 2021 Evan You
 * @license MIT
 */
function w(t){var e=Number(t.version.split(".")[0]);if(e>=2)t.mixin({beforeCreate:i});else{var s=t.prototype._init;t.prototype._init=function(t){void 0===t&&(t={}),t.init=t.init?[i].concat(t.init):i,s.call(this,t)}}function i(){var t=this.$options;t.store?this.$store="function"===typeof t.store?t.store():t.store:t.parent&&t.parent.$store&&(this.$store=t.parent.$store)}}var y="undefined"!==typeof window?window:"undefined"!==typeof s.g?s.g:{},b=y.__VUE_DEVTOOLS_GLOBAL_HOOK__;function C(t){b&&(t._devtoolHook=b,b.emit("vuex:init",t),b.on("vuex:travel-to-state",(function(e){t.replaceState(e)})),t.subscribe((function(t,e){b.emit("vuex:mutation",t,e)}),{prepend:!0}),t.subscribeAction((function(t,e){b.emit("vuex:action",t,e)}),{prepend:!0}))}function x(t,e){Object.keys(t).forEach((function(s){return e(t[s],s)}))}function k(t){return null!==t&&"object"===typeof t}function j(t){return t&&"function"===typeof t.then}function S(t,e){return function(){return t(e)}}var E=function(t,e){this.runtime=e,this._children=Object.create(null),this._rawModule=t;var s=t.state;this.state=("function"===typeof s?s():s)||{}},$={namespaced:{configurable:!0}};$.namespaced.get=function(){return!!this._rawModule.namespaced},E.prototype.addChild=function(t,e){this._children[t]=e},E.prototype.removeChild=function(t){delete this._children[t]},E.prototype.getChild=function(t){return this._children[t]},E.prototype.hasChild=function(t){return t in this._children},E.prototype.update=function(t){this._rawModule.namespaced=t.namespaced,t.actions&&(this._rawModule.actions=t.actions),t.mutations&&(this._rawModule.mutations=t.mutations),t.getters&&(this._rawModule.getters=t.getters)},E.prototype.forEachChild=function(t){x(this._children,t)},E.prototype.forEachGetter=function(t){this._rawModule.getters&&x(this._rawModule.getters,t)},E.prototype.forEachAction=function(t){this._rawModule.actions&&x(this._rawModule.actions,t)},E.prototype.forEachMutation=function(t){this._rawModule.mutations&&x(this._rawModule.mutations,t)},Object.defineProperties(E.prototype,$);var L=function(t){this.register([],t,!1)};function R(t,e,s){if(e.update(s),s.modules)for(var i in s.modules){if(!e.getChild(i))return void 0;R(t.concat(i),e.getChild(i),s.modules[i])}}L.prototype.get=function(t){return t.reduce((function(t,e){return t.getChild(e)}),this.root)},L.prototype.getNamespace=function(t){var e=this.root;return t.reduce((function(t,s){return e=e.getChild(s),t+(e.namespaced?s+"/":"")}),"")},L.prototype.update=function(t){R([],this.root,t)},L.prototype.register=function(t,e,s){var i=this;void 0===s&&(s=!0);var o=new E(e,s);if(0===t.length)this.root=o;else{var n=this.get(t.slice(0,-1));n.addChild(t[t.length-1],o)}e.modules&&x(e.modules,(function(e,o){i.register(t.concat(o),e,s)}))},L.prototype.unregister=function(t){var e=this.get(t.slice(0,-1)),s=t[t.length-1],i=e.getChild(s);i&&i.runtime&&e.removeChild(s)},L.prototype.isRegistered=function(t){var e=this.get(t.slice(0,-1)),s=t[t.length-1];return!!e&&e.hasChild(s)};var P;var F=function(t){var e=this;void 0===t&&(t={}),!P&&"undefined"!==typeof window&&window.Vue&&W(window.Vue);var s=t.plugins;void 0===s&&(s=[]);var i=t.strict;void 0===i&&(i=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new L(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new P,this._makeLocalGettersCache=Object.create(null);var o=this,n=this,r=n.dispatch,a=n.commit;this.dispatch=function(t,e){return r.call(o,t,e)},this.commit=function(t,e,s){return a.call(o,t,e,s)},this.strict=i;var c=this._modules.root.state;B(this,c,[],this._modules.root),M(this,c),s.forEach((function(t){return t(e)}));var l=void 0!==t.devtools?t.devtools:P.config.devtools;l&&C(this)},A={state:{configurable:!0}};function T(t,e,s){return e.indexOf(t)<0&&(s&&s.prepend?e.unshift(t):e.push(t)),function(){var s=e.indexOf(t);s>-1&&e.splice(s,1)}}function O(t,e){t._actions=Object.create(null),t._mutations=Object.create(null),t._wrappedGetters=Object.create(null),t._modulesNamespaceMap=Object.create(null);var s=t.state;B(t,s,[],t._modules.root,!0),M(t,s,e)}function M(t,e,s){var i=t._vm;t.getters={},t._makeLocalGettersCache=Object.create(null);var o=t._wrappedGetters,n={};x(o,(function(e,s){n[s]=S(e,t),Object.defineProperty(t.getters,s,{get:function(){return t._vm[s]},enumerable:!0})}));var r=P.config.silent;P.config.silent=!0,t._vm=new P({data:{$$state:e},computed:n}),P.config.silent=r,t.strict&&H(t),i&&(s&&t._withCommit((function(){i._data.$$state=null})),P.nextTick((function(){return i.$destroy()})))}function B(t,e,s,i,o){var n=!s.length,r=t._modules.getNamespace(s);if(i.namespaced&&(t._modulesNamespaceMap[r],t._modulesNamespaceMap[r]=i),!n&&!o){var a=Z(e,s.slice(0,-1)),c=s[s.length-1];t._withCommit((function(){P.set(a,c,i.state)}))}var l=i.context=V(t,r,s);i.forEachMutation((function(e,s){var i=r+s;U(t,i,e,l)})),i.forEachAction((function(e,s){var i=e.root?s:r+s,o=e.handler||e;G(t,i,o,l)})),i.forEachGetter((function(e,s){var i=r+s;N(t,i,e,l)})),i.forEachChild((function(i,n){B(t,e,s.concat(n),i,o)}))}function V(t,e,s){var i=""===e,o={dispatch:i?t.dispatch:function(s,i,o){var n=I(s,i,o),r=n.payload,a=n.options,c=n.type;return a&&a.root||(c=e+c),t.dispatch(c,r)},commit:i?t.commit:function(s,i,o){var n=I(s,i,o),r=n.payload,a=n.options,c=n.type;a&&a.root||(c=e+c),t.commit(c,r,a)}};return Object.defineProperties(o,{getters:{get:i?function(){return t.getters}:function(){return q(t,e)}},state:{get:function(){return Z(t.state,s)}}}),o}function q(t,e){if(!t._makeLocalGettersCache[e]){var s={},i=e.length;Object.keys(t.getters).forEach((function(o){if(o.slice(0,i)===e){var n=o.slice(i);Object.defineProperty(s,n,{get:function(){return t.getters[o]},enumerable:!0})}})),t._makeLocalGettersCache[e]=s}return t._makeLocalGettersCache[e]}function U(t,e,s,i){var o=t._mutations[e]||(t._mutations[e]=[]);o.push((function(e){s.call(t,i.state,e)}))}function G(t,e,s,i){var o=t._actions[e]||(t._actions[e]=[]);o.push((function(e){var o=s.call(t,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:t.getters,rootState:t.state},e);return j(o)||(o=Promise.resolve(o)),t._devtoolHook?o.catch((function(e){throw t._devtoolHook.emit("vuex:error",e),e})):o}))}function N(t,e,s,i){t._wrappedGetters[e]||(t._wrappedGetters[e]=function(t){return s(i.state,i.getters,t.state,t.getters)})}function H(t){t._vm.$watch((function(){return this._data.$$state}),(function(){0}),{deep:!0,sync:!0})}function Z(t,e){return e.reduce((function(t,e){return t[e]}),t)}function I(t,e,s){return k(t)&&t.type&&(s=e,e=t,t=t.type),{type:t,payload:e,options:s}}function W(t){P&&t===P||(P=t,w(P))}A.state.get=function(){return this._vm._data.$$state},A.state.set=function(t){0},F.prototype.commit=function(t,e,s){var i=this,o=I(t,e,s),n=o.type,r=o.payload,a=(o.options,{type:n,payload:r}),c=this._mutations[n];c&&(this._withCommit((function(){c.forEach((function(t){t(r)}))})),this._subscribers.slice().forEach((function(t){return t(a,i.state)})))},F.prototype.dispatch=function(t,e){var s=this,i=I(t,e),o=i.type,n=i.payload,r={type:o,payload:n},a=this._actions[o];if(a){try{this._actionSubscribers.slice().filter((function(t){return t.before})).forEach((function(t){return t.before(r,s.state)}))}catch(l){0}var c=a.length>1?Promise.all(a.map((function(t){return t(n)}))):a[0](n);return new Promise((function(t,e){c.then((function(e){try{s._actionSubscribers.filter((function(t){return t.after})).forEach((function(t){return t.after(r,s.state)}))}catch(l){0}t(e)}),(function(t){try{s._actionSubscribers.filter((function(t){return t.error})).forEach((function(e){return e.error(r,s.state,t)}))}catch(l){0}e(t)}))}))}},F.prototype.subscribe=function(t,e){return T(t,this._subscribers,e)},F.prototype.subscribeAction=function(t,e){var s="function"===typeof t?{before:t}:t;return T(s,this._actionSubscribers,e)},F.prototype.watch=function(t,e,s){var i=this;return this._watcherVM.$watch((function(){return t(i.state,i.getters)}),e,s)},F.prototype.replaceState=function(t){var e=this;this._withCommit((function(){e._vm._data.$$state=t}))},F.prototype.registerModule=function(t,e,s){void 0===s&&(s={}),"string"===typeof t&&(t=[t]),this._modules.register(t,e),B(this,this.state,t,this._modules.get(t),s.preserveState),M(this,this.state)},F.prototype.unregisterModule=function(t){var e=this;"string"===typeof t&&(t=[t]),this._modules.unregister(t),this._withCommit((function(){var s=Z(e.state,t.slice(0,-1));P.delete(s,t[t.length-1])})),O(this)},F.prototype.hasModule=function(t){return"string"===typeof t&&(t=[t]),this._modules.isRegistered(t)},F.prototype.hotUpdate=function(t){this._modules.update(t),O(this,!0)},F.prototype._withCommit=function(t){var e=this._committing;this._committing=!0,t(),this._committing=e},Object.defineProperties(F.prototype,A);var D=K((function(t,e){var s={};return z(e).forEach((function(e){var i=e.key,o=e.val;s[i]=function(){var e=this.$store.state,s=this.$store.getters;if(t){var i=Q(this.$store,"mapState",t);if(!i)return;e=i.context.state,s=i.context.getters}return"function"===typeof o?o.call(this,e,s):e[o]},s[i].vuex=!0})),s}));K((function(t,e){var s={};return z(e).forEach((function(e){var i=e.key,o=e.val;s[i]=function(){var e=[],s=arguments.length;while(s--)e[s]=arguments[s];var i=this.$store.commit;if(t){var n=Q(this.$store,"mapMutations",t);if(!n)return;i=n.context.commit}return"function"===typeof o?o.apply(this,[i].concat(e)):i.apply(this.$store,[o].concat(e))}})),s})),K((function(t,e){var s={};return z(e).forEach((function(e){var i=e.key,o=e.val;o=t+o,s[i]=function(){if(!t||Q(this.$store,"mapGetters",t))return this.$store.getters[o]},s[i].vuex=!0})),s})),K((function(t,e){var s={};return z(e).forEach((function(e){var i=e.key,o=e.val;s[i]=function(){var e=[],s=arguments.length;while(s--)e[s]=arguments[s];var i=this.$store.dispatch;if(t){var n=Q(this.$store,"mapActions",t);if(!n)return;i=n.context.dispatch}return"function"===typeof o?o.apply(this,[i].concat(e)):i.apply(this.$store,[o].concat(e))}})),s}));function z(t){return J(t)?Array.isArray(t)?t.map((function(t){return{key:t,val:t}})):Object.keys(t).map((function(e){return{key:e,val:t[e]}})):[]}function J(t){return Array.isArray(t)||k(t)}function K(t){return function(e,s){return"string"!==typeof e?(s=e,e=""):"/"!==e.charAt(e.length-1)&&(e+="/"),t(e,s)}}function Q(t,e,s){var i=t._modulesNamespaceMap[s];return i}function X(t){return new Promise((e=>{var s=document.createElement("script");s.setAttribute("src",t),s.onload=function(){console.log(" Chargement du script ok : ",t),e(!0)},document.head.appendChild(s)}))}var Y={name:"LoginGoogle",props:{idHtml:{type:String,required:!0},returnUidInfo:{type:Boolean,default:!1},classRender:{type:Array,default:function(){return["mx-auto"]}},actionAfterLogin:{type:String,required:!0}},computed:{...D(["configs_login_rx_vuejs"]),idHtmlrender(){return"google-login-tab"+this.idHtml},client_google_is_define(){return this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.client_google_id?(this.initGoogle(),!0):""}},methods:{initGoogle(){window.google?this.getUserInfoFromFrame():X("https://accounts.google.com/gsi/client").then((()=>{this.getUserInfoFromFrame()}))},getUserInfoFromFrame(){var t=this;function e(e){console.log("Encoded JWT ID token: ",e),v.userAccess={...e,client_id:e.clientId},t.TryToLoginWithGoogle(),window.rxGoogle=v}console.log(" window.onload ! ",window.onload);const s=()=>{window.google.accounts.id.initialize({client_id:this.configs_login_rx_vuejs.client_google_id,callback:e}),window.google.accounts.id.renderButton(document.getElementById(t.idHtmlrender),{theme:"outline",size:"large"}),window.google.accounts.id.prompt()};s()},TryToLoginWithGoogle(){return new Promise(((t,e)=>{l.Z.post("/login-rx-vuejs/google-check",v.userAccess).then((e=>{this.isBusy=!1,this.alertDisplay=!0,this.alertType="alert-success",this.alertText="Connexion réussie",this.$emit("ev_logingoogle",e.data),this.returnUidInfo||c.AfterRedirect(this.actionAfterLogin,null,e),t(e)})).catch((t=>{this.isBusy=!1,this.alertDisplay=!0,this.alertType="alert-danger",this.alertText="Google : Erreur de connexion",t.error&&t.error.statusText&&""!=t.error.statusText&&(this.alertText=t.error.statusText),console.log(" Error ajax ",t.error),console.log(" Error ajax ",t.code),console.log(" Error ajax ",t.stack),e(t)}))}))}}},tt=Y,et=s(1001),st=(0,et.Z)(tt,h,_,!1,null,null,null),it=st.exports,ot={name:"CheckStatus",components:{svgWaiting:()=>s.e(874).then(s.bind(s,4874)),logingoogle:it},props:{urlLogo:{type:String,required:!0},formValidate:{type:Object,required:!0},actionAfterLogin:{type:String,required:!0}},data(){return{messages:d.messages,waiting:""}},computed:{...D(["form"])},methods:{loginFacebook(){this.waiting="facebook",g.openPopup()},logOutFacebook(){g.logOut()},async checkUserStatus(){this.waiting="wait";var t="/login-rx-vuejs/check-user-status";const e=await this.formValidate.validate();e?l.Z.post(t,this.form).then((t=>{this.waiting="",t.data?this.$emit("select-stepe","setPassword"):this.$emit("select-stepe","register")})):this.waiting=""}}},nt=ot,rt=(0,et.Z)(nt,m,p,!1,null,null,null),at=rt.exports,ct=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-center"},[e("a",{staticClass:"content-center__img",attrs:{href:"/"}},[e("img",{attrs:{src:t.urlLogo,alt:""}})]),e("h3",{staticClass:"content-center__title"},[t._v(t._s(t.messages.pass))]),e("div",{staticClass:"form-group content-center__input"},[e("ValidationProvider",{ref:"refPass",attrs:{name:"pass",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){return[t.form.pass?e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.pass[0].value,expression:"form.pass[0].value"}],staticClass:"form-control",attrs:{type:"password",name:"pass"},domProps:{value:t.form.pass[0].value},on:{input:function(e){e.target.composing||t.$set(t.form.pass[0],"value",e.target.value)}}}):t._e(),e("div",{staticClass:"text-danger text-small"},t._l(s.errors,(function(s,i){return e("small",{key:i,staticClass:"d-block"},[t._v(" "+t._s(s)+" ")])})),0)]}}])})],1),e("a",{staticClass:"content-center__forgot-pass",attrs:{href:"/user/password"}},[t._v(" Mot de passe oublié ? ")]),e("div",{staticClass:"content-center__btn"},[e("div",{staticClass:"btn-login btn-login--connexion",on:{click:t.Login}},[e("span",{staticClass:"btn-login__text"},[t._v(" "+t._s(t.messages.submit.connect)+" ")]),"wait"==t.waiting?e("svgWaiting"):t._e()],1)]),e("hr"),e("a",{staticClass:"text-center d-block",attrs:{href:"#"},on:{click:function(e){return t.$emit("select-stepe","checkstatus")}}},[t._v(" Retour ")])])},lt=[],ut={name:"SetPassword",components:{svgWaiting:()=>s.e(874).then(s.bind(s,4874))},props:{urlLogo:{type:String,required:!0},formValidate:{type:Object,required:!0},actionAfterLogin:{type:String,required:!0}},data(){return{messages:d.messages,waiting:""}},computed:{...D(["form"])},mounted(){void 0===this.form.pass&&this.$set(this.form,"pass",[{value:""}])},methods:{async Login(){this.waiting="wait";const t=await this.formValidate.validate();setTimeout((()=>{t?d.connexionUser(this.form,this.actionAfterLogin).then((()=>{this.waiting=""})).catch((t=>{console.log("Login : ",t),this.$refs.refPass.setErrors([t.error.statusText]),this.waiting="error"})):this.waiting=""}),3e3)}}},dt=ut,ft=(0,et.Z)(dt,ct,lt,!1,null,null,null),gt=ft.exports,mt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"content-center"},[e("a",{staticClass:"content-center__img",attrs:{href:"/"}},[e("img",{attrs:{src:t.urlLogo,alt:""}})]),"default"===t.modelRegisterFormResult?e("div",[e("h3",{staticClass:"content-center__title"},[t._v(t._s(t.messages.login))]),e("div",{staticClass:"form-group content-center__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name[0].value,expression:"form.name[0].value"}],staticClass:"form-control",attrs:{type:"text",readonly:"true",name:"name"},domProps:{value:t.form.name[0].value},on:{input:function(e){e.target.composing||t.$set(t.form.name[0],"value",e.target.value)}}})]),t.showPassword?e("h3",{staticClass:"content-center__title"},[t._v(" "+t._s(t.messages.pass)+" ")]):t._e(),t.showPassword?e("div",{staticClass:"form-group content-center__input"},[t.form.pass?e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.pass[0].value,expression:"form.pass[0].value"}],staticClass:"form-control",attrs:{type:"password",name:"pass"},domProps:{value:t.form.pass[0].value},on:{input:function(e){e.target.composing||t.$set(t.form.pass[0],"value",e.target.value)}}}):t._e()]):t._e(),e("h3",{staticClass:"content-center__title"},[t._v(t._s(t.messages.mail))]),e("ValidationProvider",{ref:"mail",staticClass:"d-block w-100",attrs:{name:"mail",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"form-group content-center__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.mail[0].value,expression:"form.mail[0].value"}],staticClass:"form-control",attrs:{type:"mail",name:"mail"},domProps:{value:t.form.mail[0].value},on:{input:function(e){e.target.composing||t.$set(t.form.mail[0],"value",e.target.value)}}})]),e("div",{staticClass:"text-danger text-small"},t._l(s.errors,(function(s,i){return e("small",{key:i,staticClass:"d-block"},[t._v(" "+t._s(s)+" ")])})),0)]}}],null,!1,3187930093)}),t._l(t.templates,(function(s,i){return e("ValidationProvider",{key:i,ref:s.ref,refInFor:!0,staticClass:"d-block w-100",scopedSlots:t._u([{key:"default",fn:function(i){return[e(s,{tag:"component"}),e("div",{staticClass:"text-danger text-small"},t._l(i.errors,(function(s,i){return e("small",{key:i,staticClass:"d-block"},[t._v(" "+t._s(s)+" ")])})),0)]}}],null,!0)})})),e("div",{staticClass:"content-center__btn"},[e("div",{staticClass:"btn-login btn-login--connexion",on:{click:t.RegisterDefault}},[e("span",{staticClass:"btn-login__text"},[t._v(" "+t._s(t.messages.submit.register)+" ")]),"wait"==t.waiting?e("svgWaiting"):t._e()],1)]),e("hr")],2):t._e(),"generate_password"===t.modelRegisterFormResult?e("div",[e("h4",{staticClass:"title"},[t._v("Creation automatique du compte")]),e("p",{staticClass:"mb-4"},[t._v(" Vos informations de connexion seront transferés à cette adresse. ")]),t.validEmail(t.form.name[0].value)?e("div",{staticClass:"mb-5"},[e("strong",[t._v(" "+t._s(t.form.name[0].value)+" ")]),t._v(" "+t._s(t.set_email())+" ")]):t._e(),t.validEmail(t.form.name[0].value)?t._e():e("div",[e("ValidationProvider",{ref:"mail",staticClass:"d-block w-100",attrs:{name:"mail",rules:"required"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"form-group content-center__input"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.mail[0].value,expression:"form.mail[0].value"}],staticClass:"form-control",attrs:{type:"mail",name:"mail"},domProps:{value:t.form.mail[0].value},on:{input:function(e){e.target.composing||t.$set(t.form.mail[0],"value",e.target.value)}}})]),e("div",{staticClass:"text-danger text-small"},t._l(s.errors,(function(s,i){return e("small",{key:i,staticClass:"d-block"},[t._v(" "+t._s(s)+" ")])})),0)]}}],null,!1,3187930093)})],1),e("div",{staticClass:"content-center__btn"},[e("div",{staticClass:"btn-login btn-login--connexion",on:{click:t.generatePassword}},[e("span",{staticClass:"btn-login__text"},[t._v(" "+t._s(t.messages.submit.register)+" ")]),"wait"==t.waiting?e("svgWaiting"):t._e()],1)])]):t._e(),e("b-alert",{attrs:{dismissible:"",variant:"danger",fade:"",show:!!t.error.message},on:{dismissed:function(e){t.error.message=!1}}},[t._v(" "+t._s(t.error.message)+" ")]),e("a",{staticClass:"text-center d-block",attrs:{href:"#"},on:{click:function(e){return t.$emit("select-stepe","checkstatus")}}},[t._v(" Retour ")])],1)},pt=[],ht={modelsFields:{},string(t,e,s=[]){0===s.length&&s.push({value:""});const i=[];i.push(t("label",{class:["d-block","content-center__title"]},[e.label_value])),s.forEach((e=>{i.push(t("input",{props:{type:"text",value:e.value,b_input:{type:Object,required:!0}},on:{input:function(t){t.target&&t.target.value&&(e.value=t.target.value)}},class:["form-control"]}))})),i.push(t("small",{class:["text-muted"]},[e.description]));const o=t("div",{props:{},class:["form-group","content-center__input"]},i);return o}};class _t{constructor(t,e){this.entity=t,this.bundle=e}async format(){var t=await this.getFields();return new Promise(((e,s)=>{if(t.data&&t.data.fields){ht.modelsFields=this.buildModel(t.data.fields);const s=[];for(const e in t.data.fields)s.push({ref:e,props:{name:{type:String,default:t.data.fields[e].name}},render(s){var i=[];switch(t.data.fields[e].type){case"string":i.push(ht.string(s,t.data.fields[e],ht.modelsFields[e]));break}return s("div",i)}});e({templates:s,models:ht.modelsFields})}else s("Aucune donnée disponible")}))}getFields(){var t="/api/form-node/generate-form";return"user"===this.entity&&(t="/api/form-node/generate-user"),t+="/"+this.bundle,l.Z.get(t)}buildModel(t){const e={};for(const s in t)t[s].type&&(e[s]=[]);return e}}var vt=_t,wt={name:"RegisTer",components:{svgWaiting:()=>s.e(874).then(s.bind(s,4874))},props:{urlLogo:{type:String,required:!0},formValidate:{type:Object,required:!0},showPassword:{type:Boolean,default:!1},actionAfterRegister:{type:String,required:!0},modelRegisterForm:{type:[String,Boolean],required:!0},showModalSuccess:{type:Boolean,required:!0}},data(){return{messages:d.messages,waiting:"",templates:[],error:{message:!1}}},computed:{...D(["form","configs_login_rx_vuejs"]),modelRegisterFormResult(){return this.modelRegisterForm?this.modelRegisterForms:this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.generate_user?"generate_password":"default"}},mounted(){this.showPassword?void 0===this.form.pass&&this.$set(this.form,"pass",[{value:""}]):this.form.pass&&delete this.form.pass,this.getFields()},methods:{async generatePassword(){this.waiting="wait";var t="/login-rx-vuejs/genrate-password";const e=await this.formValidate.validate();e?l.Z.post(t,this.form).then((t=>{console.log("resp : ",t),this.waiting="",d.AfterRedirect(this.actionAfterRegister,null,t)})).catch((()=>{this.waiting=""})):(this.waiting="",console.log("echec de validation de mail"))},async RegisterDefault(){this.waiting="wait";var t="/user/register?_format=json";const e=await this.formValidate.validate();e?l.Z.post(t,this.form).then((t=>{this.waiting="",this.showModalSuccess?d.modalSuccess(d.msgCreate([this.messages.devis_create_user]),{title:"Votre compte a été crré",footerClass:"d-none",headerBgVariant:"success",headerTextVariant:"light"}).then((()=>{d.AfterRedirect(this.actionAfterRegister,null,t)})):d.AfterRedirect(this.actionAfterRegister,null,t)})).catch((t=>{if(this.waiting="",console.log("catch : ",t),t.error.data&&t.error.data.message&&(this.error.message=t.error.data.message),t.error&&t.error.data&&t.error.data.errors){const e=t.error.data.errors;e.forEach((t=>{const e=t.split(":");this.$refs[e[0]]&&(this.$refs[e[0]][0]?this.$refs[e[0]][0].setErrors([e[1]]):this.$refs[e[0]].setErrors([e[1]]))}))}})):this.waiting=""},getFields(){const t=new vt("user","user");t.format().then((t=>{this.templates=t.templates;for(const e in t.models)this.$set(this.form,e,t.models[e]);console.log("resp : ",t)}))},validEmail(t){var e=/\S+@\S+\.\S+/;return e.test(t)},set_email(){this.form.mail=this.form.name}}},yt=wt,bt=(0,et.Z)(yt,mt,pt,!1,null,null,null),Ct=bt.exports,xt={name:"LoginRegister",props:{actionAfterLogin:{type:String,default:"default"},actionAfterRegister:{type:String,default:"default"},modelRegisterForm:{type:[String,Boolean],default:!1},showPassword:{type:Boolean,default:!0},showModalSuccess:{type:Boolean,default:!0}},data(){return{messages:d.messages,waiting:"",stepe:at,models:{},baseURl:f.Z.baseURl,isBusy:!1,alertDisplay:!1,alertType:"alert-danger",alertText:"",urlLogo:window.location.origin+""+window.logo_current_theme,formValidate:{}}},computed:{...D(["configs_login_rx_vuejs"]),facebook_app_is_define(){return this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.facebook_app_id?(this.initFacebook(),!0):""}},mounted(){this.formValidate=this.$refs.formValidate,this.getConfigs()},methods:{initFacebook(){g.appId=this.configs_login_rx_vuejs.facebook_app_id,this.TryToLoginWithFacebook(),g.chargement()},selectStepe(t){switch(t){case"checkstatus":this.stepe=at;break;case"setPassword":this.stepe=gt;break;case"register":this.stepe=Ct;break}},TryToLoginWithFacebook(){document.addEventListener("wbu-fb-status-change",(()=>{this.isBusy=!0,this.getFields(),l.Z.post("/login-rx-vuejs/facebook-check",g.user).then((t=>{this.isBusy=!1,this.alertDisplay=!0,this.alertType="alert-success",this.alertText=" Connexion réussie  ",t.reponse&&t.reponse.config.url!==t.reponse.request.responseURL?window.location.assign(t.reponse.request.responseURL):t.data&&t.data.createuser?this.stepe="final-fb-register":window.location.assign(window.location.origin)})).catch((t=>{this.isBusy=!1,this.isBusy=!1,this.alertDisplay=!0,this.alertType="alert-danger",this.alertText="Facebook : Erreur de connexion ",t.error&&(this.alertText=t.error.statusText)}))}),!1)},IsBusy(){this.isBusy=!0,console.log("this.isbusy",this.isBusy)},async finalRegister(){this.waiting="wait";var t={},e="";"final-gl-register"===this.stepe?(e="/login-rx-vuejs/google-login",t={fields:this.models,google:[]}):"final-fb-register"===this.stepe&&(e="/login-rx-vuejs/facebook-login",t={fields:this.models,facebook:g.user});const s=await this.$refs.formValidate.validate();s&&l.Z.post(e,t).then((t=>{console.log(t),this.waiting="",t.reponse&&t.reponse.config.url!==t.reponse.request.responseURL&&window.location.assign(t.reponse.request.responseURL)}))},connexionUser(t){return d.connexionUser(t,this.actionAfterLogin)},getConfigs(){var t="/login-rx-vuejs/get-configs";l.Z.post(t,this.form).then((t=>{this.$store.state.configs_login_rx_vuejs=t.data})).catch((t=>{console.log(t)}))}}},kt=xt,jt=(0,et.Z)(kt,i,o,!1,null,null,null),St=jt.exports}}]);
//# sourceMappingURL=BuilderCv.umd.min.644.js.map